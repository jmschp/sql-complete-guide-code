# 123. Many-to-Many Relationships & Intermediate Tables ("Linking Tables")

To setup the relationship between projects and employees we will need an intermediate table, as this is a Many-to-Many relationship, one employee can belong to many projects and a project can have many employees. The naming convention of intermediate tables, is a combination of the name of the two initial tables, in this case we could use `projects_employees`, or sometimes we could use one of the names its singular from, like `project_employees`.

With the intermediate table (join table) `projects_employees`, we now have a record per each project and employee. So if a project has 5 employees we will have 5 records relative to this project, with the corresponding employee, in the `projects_employees`table.

```sql
CREATE TABLE projects (
  id SERIAL PRIMARY KEY,
  title VARCHAR(300) NOT NULL,
  deadline DATE
);

CREATE TABLE company_buildings (
  id SERIAL PRIMARY KEY,
  name VARCHAR(300) NOT NULL
);

CREATE TABLE teams (
  id SERIAL PRIMARY KEY,
  name VARCHAR(300) NOT NULL,
  building_id INT REFERENCES company_buildings ON DELETE
  SET NULL
);

CREATE TABLE employees (
  id SERIAL PRIMARY KEY,
  first_name VARCHAR(300) NOT NULL,
  last_name VARCHAR(300) NOT NULL,
  birthdate DATE NOT NULL,
  email VARCHAR(200) UNIQUE NOT NULL,
  team_id INT DEFAULT 1 REFERENCES teams ON DELETE
  SET DEFAULT
);

CREATE TABLE intranet_accounts (
  id SERIAL PRIMARY KEY,
  email VARCHAR(200) REFERENCES employees (email) ON DELETE CASCADE,
  password VARCHAR(200) NOT NULL
);

-- Intermediate table => n:n
CREATE TABLE projects_employees (
  id SERIAL PRIMARY KEY,
  employee_id INT REFERENCES employees ON DELETE CASCADE,
  project_id INT REFERENCES projects ON DELETE CASCADE
);
```

_View [slides 53 and 54](./slides/slides.pdf) for more details._

_View sql file [23-final-setup](./sql/23-final-setup.sql) for more details._
