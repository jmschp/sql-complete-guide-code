# 135. Self-Referencing Many To Many Relationships

In a self-referencing many-to-many relationship we need a intermediate table to join records, just like in a standard many-to-many. The intermediate table, or join table, will have 2 Foreign Keys to the same table.

In this type of association there is a caveat, if we don't set up any type of constrain in the intermediate table we might end up with two records that have the same meaning. The same association in the intermediate table can be represented in two different ways, to prevent this we can set a check, as we see in the example below.

```sql
CREATE TABLE table_a_name (
  id SERIAL PRIMARY KEY,
  column_1_name VARCHAR(255),
);

CREATE TABLE intermediate_table_name (
  foreign_key_1_name INT REFERENCES table_a_name (id),
  foreign_key_2_name INT REFERENCES table_a_name (id)
  CHECK (foreign_key_1_name < foreign_key_2_name)
  PRIMARY KEY (foreign_key_1_name, foreign_key_2_name) -- We can set a Composite Primary Key, or a standard Primary Key, depending on business logic needs.
);
```

_View [slide 8](./slides/slides.pdf) for more details._

_View sql file [06-self-referencing-many](./sql/06-self-referencing-many.sql) for more details._

_View sql file [07-insert-many-to-many-data](./sql/07-insert-many-to-many-data.sql) for more details._
