# 158. Calculating INTERVALS

## PostgreSQL

We can calculate differences in date and time using mathematical operator `-`, and the output will be an `INTERVAL` data type value.

```sql
SELECT '2022-12-22 10:00:00'::TIMESTAMP - '2022-12-18 10:15:00'::TIMESTAMP; -- INTERVAL -> 3 days 23:44:40

SELECT '10:00:00'::TIME - '10:15:20'::TIME; -- INTERVAL -> -00:15:20

-- For DATE values we get an INTEGER
SELECT '2022-12-22'::DATE - '2022-12-18'::DATE; -- INTEGER (days) -> 4

SELECT timestamp_column_1 - timestamp_column_2
FROM table_name
```

## MySQL

For MySQL we have to functions to calculate the difference between two moments in time, `DATEDIFF()`, `TIMEDIFF()`, `TIMESTAMPDIFF()`.

MySQL definition:

> `DATEDIFF(expr1,expr2)`
>
> `DATEDIFF()` returns **expr1 − expr2** expressed as a value in days from one date to the other. **expr1** and **expr2** are date or date-and-time expressions. Only the date parts of the values are used in the calculation.
>
> ```sql
> SELECT DATEDIFF('2007-12-31 23:59:59', '2007-12-30'); -- 1
> SELECT DATEDIFF('2010-11-30 23:59:59', '2010-12-31');-- -31
> ```
>
> This function returns NULL if expr1 or expr2 is NULL.
>
> ---
>
> `TIMEDIFF(expr1,expr2)`
>
> `TIMEDIFF()` returns **expr1 − expr2** expressed as a time value. **expr1** and **expr2** are strings which are converted to `TIME` or `DATETIME` expressions; these must be of the same type following conversion. Returns NULL if **expr1** or **expr2** is `NULL`.
>
> The result returned by `TIMEDIFF()` is limited to the range allowed for `TIME` values. Alternatively, you can use either of the functions `TIMESTAMPDIFF()` and `UNIX_TIMESTAMP()`, both of which return integers.
>
> ```sql
> SELECT TIMEDIFF('2000-01-01 00:00:00', '2000-01-01 00:00:00.000001'); -- '-00:00:00.000001'
> SELECT TIMEDIFF('2008-12-31 23:59:59.000001', '2008-12-30 01:01:01.000002'); -- '46:58:57.999999'
> ```
>
> ---
>
> `TIMESTAMPDIFF(unit,datetime_expr1,datetime_expr2)`
>
> Returns **datetime_expr2 − datetime_expr1**, where **datetime_expr1** and **datetime_expr2** are `date` or `datetime` expressions. One expression may be a `date` and the other a `datetime`; a `date` value is treated as a `datetime` having the time part '00:00:00' where necessary. The unit for the result (an integer) is given by the unit argument. The legal values for unit are the same as those listed in the description of the `TIMESTAMPADD()` function. (`SECOND`, `MINUTE`, `HOUR`, `DAY`, `WEEK`, `MONTH`, `QUARTER`, or `YEAR`.)
>
> This function returns NULL if datetime_expr1 or datetime_expr2 is NULL.
>
> ```sql
> SELECT TIMESTAMPDIFF(MONTH,'2003-02-01','2003-05-01'); -- 3
> SELECT TIMESTAMPDIFF(YEAR,'2002-05-01','2001-01-01'); -- -1
> SELECT TIMESTAMPDIFF(MINUTE,'2003-02-01','2003-05-01 12:05:55'); -- 128885
> ```

- [MySQL DATEDIFF()](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_datediff)
- [MySQL TIMEDIFF()](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_timediff)
- [MySQL TIMESTAMPDIFF()](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_timestampdiff)

_View sql file [04-date-time-differences](./sql/04-date-time-differences.sql) for more details._
